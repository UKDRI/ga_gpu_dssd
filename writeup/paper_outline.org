#+TITLE: Deciphering Dopaminergic Heterogeneity: A GPU-Accelerated Evolutionary Framework Identifies Distinct Metabolic, Fibrotic, and Iron-Toxic States in Parkinson’s Disease
#+AUTHOR: Sam Neaves
#+DATE: <2025-11-28>
#+OPTIONS: toc:nil num:t

* Abstract
- Background :: Parkinson's Disease (PD) is characterized by the progressive loss of dopaminergic neurons, yet scRNA-seq reveals high heterogeneity in cellular decline. Standard clustering often fails to resolve overlapping failure modes or distinguish disease-specific states from healthy stress responses.
- Methodology :: We applied Diverse Subgroup Set Discovery (DSSD) using a custom **Parallel Genetic Algorithm** on the DAWN HPC (Intel PVC GPUs). Unlike greedy algorithms, our framework evolves a set of rules simultaneously to maximize population coverage while minimizing redundancy. We validated findings using "Shadow Runs" (blinded re-discovery) and Differential Enrichment Analysis against background PD and Control populations.
- Rigor :: We addressed the "look-elsewhere" effect via a massive-scale permutation test, running 1,000 concurrent searches on real and randomized data (~72,000 GPU-hours equivalent).
- Results :: The framework identified a global solution with fitness statistically unreachable by chance ($p < 0.001$). This solution decomposed the PD population into three distinct, non-overlapping failure modes: (1) A **Metabolic Compensation** state defined by /NCOR2/ loss and mitochondrial upregulation; (2) An **Iron-Toxic** state defined by /FTH1/ and /CRYAB/-mediated stress; and (3) A **Fibrotic/Senescent** state defined by /PALD1/ and /LINGO1/ which is notably absent in healthy controls.
- Conclusion :: We demonstrate that GPU-accelerated evolutionary mining can robustly untangle the "mixed bag" of neurodegeneration into actionable, mechanistically distinct cell states.

* Introduction

** The Biological Challenge: Gain of Dysfunction and Loss of Health
- Parkinson’s Disease (PD) degeneration is asynchronous. At any given moment, the substantia nigra contains a "mixed bag" of healthy, compensating, and dying cells.
- Standard analysis pipelines typically rely on unsupervised clustering (e.g., Louvain/Leiden) followed by differential expression. However, this approach faces two fundamental limitations when dissecting disease heterogeneity:
  1. **Post-hoc Association vs. Supervised Search:** Clustering partitions cells based on *global* transcriptomic similarity (e.g., cell type identity) and only assesses disease association *post-hoc*. This risks drowning out subtle, disease-specific signals that do not drive the principal components of variance. In contrast, Subgroup Discovery is inherently **supervised**: it utilizes the disease labels (PD vs. CTRL) directly within the search objective, optimizing specifically for rules that discriminate cellular states associated with the pathology.
  2. **Exhaustive Partitioning vs. Local Discovery:** Clustering algorithms are typically exhaustive, forcing every cell—including noisy or ambiguous ones—into a distinct group. This often obscures rare or transitional states within larger "garbage collector" clusters. DSSD, conversely, does not attempt to model the entire population. Instead, it acts as a "spotlight," identifying only the specific subsets of cells that carry a strong biological signal while leaving the uninformative background unstructured.
- While standard clustering imposes mutual exclusion as a mathematical constraint, DSSD allows for the discovery of overlapping rules. However, by explicitly penalizing redundancy in our evolutionary framework, we aim to discover **non-overlapping, orthogonal subgroups** that represent distinct, independent failure modes rather than redundant descriptions of the same phenomenon.

** The Computational Innovation: From Patient Stratification to Cellular States
Subgroup Discovery (SD) has a rich history in bioinformatics. In the microarray era, seminal work by **Gamberger et al. (2004)** demonstrated that SD could induce "comprehensible models" for gene expression. Rather than building black-box classifiers, their approach identified explicit rules (e.g., /"IF Gene X is Expressed AND Gene Y is Not Expressed"/ [cite: 1533]) to describe specific subpopulations of patients[cite: 1266].

However, these early applications were defined by the "Small $N$, Large $P$" problem of microarrays ($N < 150$ patients)[cite: 1256]. The discovered subgroups represented **patient stratification**—identifying subsets of individuals with specific disease subtypes (e.g., specific forms of Leukemia)[cite: 1250, 1533].

We repurpose this framework for the single-cell era, where $N$ is measured in thousands of cells. By treating **individual cells as instances**, we shift the focus from *Patient Stratification* to **Cell State Discovery**. We posit that non-overlapping subgroups in scRNA-seq data represent distinct, stable "attractor states" (e.g., Metabolic vs. Fibrotic) that co-exist within the same tissue, rather than different disease diagnoses.

** Why DSSD? Set Optimization vs. Sequential Covering
Traditional Subgroup Discovery algorithms often address redundancy through **Sequential Covering** (e.g., CN2-SD). In this approach, once a subgroup is found, the examples it covers are "down-weighted," encouraging the algorithm to look elsewhere for the next subgroup. While this does promote diversity, it is still a **greedy, iterative process**: the first subgroup found dictates the residual search space for the second.

**The DSSD Advantage:** We argue that biological states are not "residuals" of one another. To capture the true complexity of cellular heterogeneity, we need to optimize the **entire solution set simultaneously**.

DSSD treats the identification of cell states as a **Set Optimization Problem**. Instead of iteratively picking the "next best" rule, our Genetic Algorithm evolves a chromosome representing a complete set of $k$ subgroups. The fitness function evaluates the collective merit of this set, penalizing overlap between members. This allows the algorithm to discover a global optimum—a "team" of orthogonal subgroups (Metabolic, Iron, Fibrotic)—that best explains the dataset's heterogeneity, rather than a sequence of decreasingly important residuals.


* Methods
** Single-Cell Data Preprocessing
- *Dataset:* 6,385 dopaminergic neurons (Control vs. PD).
- *Input:* Top 1,000 variable genes, binarized to facilitate logical rule generation.

** The Hierarchical GPU-Accelerated Framework
To navigate the combinatorial search space, we developed a two-tier parallel Genetic Algorithm (GA) optimized for Intel PVC GPUs.

- *Tier 1 (Vectorized Intra-Node):* We utilize custom PyTorch kernels to evaluate 10 independent GA populations (Pop=55) simultaneously on a single GPU. By creating a dense tensor of size $[10 \times 55 \times 1000]$ and utilizing =int8= bit-packing, we achieve massive throughput for the boolean logic operations required by rule evaluation.
- *Tier 2 (Distributed Inter-Node):* The search is scaled across 100 GPU nodes. Task 0 processes the Real Data, while Tasks 1-99 process 999 randomized permutations to establish a rigorous null distribution.

To maximize throughput, we utilized custom PyTorch kernels that operate on packed =int8= tensors. A population of 55 individuals and 1,000 features is represented as a dense binary matrix. Evaluation of rules is vectorized across 10 independent populations simultaneously using broadcasting, converting the boolean logic =(Rule_Mask OR Data_Value)= into efficient bitwise GPU operations. This architecture allows the evaluation of millions of candidate rules per second, a scale previously unattainable with CPU-based iterators.  
** Fitness Function: Optimizing for Diversity
We employ a modified Weighted Relative Accuracy (WRAcc) that explicitly accounts for set diversity. The fitness $F$ of a chromosome (a set of $k$ rules) is defined as:

$$ F = \frac{\sum_{i=1}^{k} WRAcc(Rule_i)}{1 + \lambda \cdot Overlap(Rule_1...Rule_k)} $$

Where $\lambda$ is a penalty factor for cells covered by multiple rules. This drives the evolutionary pressure towards finding **non-overlapping** cell states.




** Biological Characterization (Phase 1.5)
While the GA generates fully interpretable rule definitions (e.g., =PALD1=1=), we performed **Differential Enrichment Analysis (DEA)** to map these rules to broader pathobiological contexts:
1.  *Internal DEA:* Compared Subgroup PD cells vs. Background PD cells to identify specific "failure modes."
2.  *External DEA:* Compared Subgroup Control cells vs. Background Control cells to determine disease specificity.
3.  *Validation:* Gene lists were validated against the Gene Ontology (GO) database using =gseapy=.

* Results
** Computational & Statistical Performance
The framework executed a deep search equivalent to ~72,000 hours of sequential computation in <36 hours. The "Real Data" champion achieved a fitness of **0.0621**, while the maximum fitness found in 999 randomized datasets was **0.0294**.

#+CAPTION: Empirical Null Distribution generated via 1,000 GPU-accelerated permutation tests. The red line ($F_{real}$) indicates the fitness of the discovered rule set, significantly exceeding the maximum fitness found in random noise ($p < 0.001$).
#+NAME: fig:fitness_histogram
#+ATTR_LATEX: :width 0.8\textwidth :placement [H]
[[../18nov_prod_36hours/fitness_histogram.png]]
** Comparison with Standard Clustering
We compared the DSSD subgroups to standard Leiden clustering (resolution 0.5). While clustering correctly identified global cell types (e.g., general dopaminergic identity), it failed to resolve the specific pathological states. For example, the **Rule 2 (Iron-Toxic)** cells were dispersed across multiple standard clusters, indicating that this stress state cuts across global transcriptomic identities and is invisible to standard variance-based partitioning.
** Biological Discovery: A Triple Dissociation of Failure Modes
The DSSD algorithm successfully decomposed the PD population into three robust, non-overlapping subgroups. The lack of overlap suggests these represent distinct "Attractor States" of cellular failure rather than a continuous gradient.

** Validation via Blinded Re-Discovery ("Shadow Run")
To rigorously test the hypothesis that the three discovered states represent the exhaustive dominant signals in the dataset, we performed a "Shadow Run." We created a blinded dataset by removing all 19 genes associated with the primary rules (including /PALD1/, /FTH1/, /NCOR2/) and re-deployed the GPU framework.

If the dataset contained a hidden fourth mechanism (e.g., an Inflammation-driven state distinct from the Iron/Fibrosis states), the algorithm would be expected to converge on this new signal. However, the Shadow Run failed to identify any subgroup with a fitness score exceeding the permutation noise floor ($p > 0.05$). This result strongly suggests that the three described failure modes—Metabolic, Iron-Toxic, and Fibrotic—constitute the comprehensive landscape of transcriptomic heterogeneity in this cohort, rather than merely being the first of many weak signals.


#+CAPTION: Subgroup Coverage and Composition. This back-to-back bar chart illustrates the number of Parkinson's Disease (PD, orange) and Control (CTRL, blue) cells covered by the top discovered rules. Rule 1 and Rule 2 identify highly specific minority populations, while Rule 4 captures a broader, yet still significantly enriched, PD subgroup.
#+NAME: fig:subgroup_composition
#+ATTR_LATEX: :width 0.9\textwidth :placement [H]
[[../18nov_prod_36hours/subgroup_analysis.png]]

*** 1. The Metabolic Compensation State (Rule 1)
- *Definition:* =NCOR2=0 AND MT-ND4L=1...=
- *Mechanism:* The loss of the nuclear repressor =NCOR2= co-occurs with a massive upregulation of Mitochondrial Complex I and IV subunits (=MT-ND4=, =MT-CO3=). This suggests a population under severe metabolic stress attempting to restore ATP deficits via transcriptional compensation.
- *Validation:* GO analysis confirmed enrichment for "Mitochondrial Respiratory Chain Complex Assembly" ($p < 10^{-20}$).

*** 2. The Iron-Toxic Stress State (Rule 2)
- *Definition:* =FTH1=1 AND RBX1=0...=
- *Mechanism:* Defined by high Ferritin Heavy/Light Chain (=FTH1=, =FTL=). Crucially, this is the *only* subgroup that upregulates **=CRYAB=**, a heat-shock protein linked to alpha-synuclein aggregation protection. This distinguishes it as a state of active Iron Toxicity management.
- *Validation:* GO analysis confirmed "Cytoplasmic Translation" ($p < 0.001$), reflecting the high protein synthesis demand of Ferritin sequestration.

*** 3. The Fibrotic/Senescent State (Rule 4)
- *Definition:* =PALD1=1=
- *Mechanism:* This state is enriched for **=LINGO1=** (negative regulator of axonal repair) and extracellular matrix collagens (=COL27A1=).
- *Disease Specificity:* External DEA revealed that while =PALD1+= cells exist in healthy controls (marked by =RBFOX3=), the pathological markers =LINGO1= and =COL5A1= are **exclusive to the PD population**.
- *Validation:* GO analysis confirmed "Extracellular Matrix Organization" ($p < 10^{-8}$) and "Regulation of Small GTPase Signaling."

#+CAPTION: Differential Enrichment Heatmap proving the **Double Dissociation** of cell states. Rule 1 is uniquely enriched for mitochondrial genes (Top Left, Red) but depleted for fibrosis markers. Rule 4 is uniquely enriched for fibrosis/senescence markers (Bottom Right, Red). Rule 2 shows a distinct Iron/Stress signature.
#+NAME: fig:mechanism_heatmap
#+ATTR_LATEX: :width 0.7\textwidth :placement [H]
[[./images/mechanism_heatmap.png]]

#+CAPTION: Pathway and Ontology Validation. Over-Representation Analysis (ORA) confirms that the differentially enriched genes for each subgroup map to distinct, statistically significant biological mechanisms. Bars represent the negative log p-value.
#+NAME: fig:pathway_validation
#+ATTR_LATEX: :width 0.65\textwidth :placement [H]
[[./images/pathway_validation_figure.png]]

** Differential Enrichment Reveals Mutually Exclusive Pathologies
To determine if the discovered subgroups represented distinct biological states or merely varying degrees of general cellular stress, we analyzed the co-expression of key pathway markers across the three groups (Figure [[fig:mechanism_heatmap]]).

The analysis revealed a striking **triple dissociation** between the Metabolic, Iron-Toxic, and Fibrotic states:

1.  **Metabolic Specificity:** Cells in the **Metabolic Subgroup (Rule 1)** exhibited a specific upregulation of mitochondrial complex I and IV genes (mean enrichment +0.18 to +0.26) while showing depletion or baseline levels of fibrosis markers.
2.  **Fibrotic Specificity:** Conversely, cells in the **Fibrotic Subgroup (Rule 4)** showed strong upregulation of /LINGO1/ and /COL27A1/ (+0.21 to +0.23) but downregulation of mitochondrial genes (e.g., /MT-CO3/ -0.06).
3.  **Iron/Stress Specificity:** The **Iron Subgroup (Rule 2)** displayed a unique signature defined by /FTL/ and /CRYAB/ (+0.11 to +0.12). Crucially, these cells did not show the broad mitochondrial upregulation of Rule 1 nor the fibrotic scarring of Rule 4, confirming that Iron Toxicity represents an independent axis of cellular failure.

This "anti-correlation" of mechanisms confirms that these are not random subsets of sick cells, but rather mutually exclusive attractor states. A neuron effectively commits to a specific failure mode: it engages a metabolic overdrive (Rule 1), succumbs to fibrotic remodeling (Rule 4), or battles iron toxicity (Rule 2), but rarely exhibits all three pathologies simultaneously.

** Disease-Specificity of the Fibrotic State
We further investigated whether these cellular states represent physiological functions or pathological transformations by applying the discovered rules to the healthy control population.

While the **Metabolic State (Rule 1)** was detectable in controls, the **Fibrotic State (Rule 4)** showed a qualitative transformation in the disease context. In controls, /PALD1/+ neurons expressed healthy neuronal markers (/RBFOX3/, /PRDM16/) but lacked the pathological signature. In PD patients, this same cell lineage specifically acquired the expression of **=LINGO1=** (an inhibitor of regeneration) and extracellular matrix collagens. This identifies the /PALD1/+ lineage as a selectively vulnerable population that undergoes a specific fibrotic transformation in the disease environment.

** Chronological Ordering via Transcriptomic Distance
To infer the progression of these disease states, we calculated the Manhattan distance of each subgroup's transcriptomic profile from a "Healthy Control" centroid (Figure [[fig:trajectory_boxplot]]).

This analysis revealed a clear hierarchy of degeneration. The **Iron-Toxic (Rule 2)** and **Metabolic (Rule 1)** states exhibited the lowest distance from health (Median Distance $\approx$ 305), suggesting they represent early, homeostatic stress responses where neuronal identity is largely preserved. In contrast, the **Fibrotic State (Rule 4)** showed the greatest divergence (Median Distance $\approx$ 340, $p < 0.001$), confirming its status as a terminal, irreversible state where the transcriptomic landscape has been fundamentally remodeled towards senescence and scarring.

[[./images/trajectory_boxplot.png]]

* Discussion
** Beyond the "Table Mountain"
A key challenge in Subgroup Discovery is the "Table Mountain" problem (van Leeuwen & Knobbe, 2012), where algorithms return redundant variations of the single strongest signal. By using DSSD with a diversity-aware fitness function, we forced the algorithm to step off the primary peak (likely Rule 4/Fibrosis) and discover the orthogonal Rule 1 (Metabolic) and Rule 2 (Iron) peaks.

This confirms that PD heterogeneity is not random noise, but a structured composition of distinct failure modes. The algorithm effectively "de-mixed" the transcriptomic signal into its constituent drivers.

** Therapeutic Implications
The clear separation of these states has profound implications for precision medicine:
- **Anti-LINGO1 therapies** (currently in trials) may only target the specific **Rule 4** sub-population ("Scarred Neurons").
- **Mitochondrial co-factors** would likely target the **Rule 1** population but may be ineffective for the **Rule 2** (Iron-Toxic) group, which requires chelation or aggregation inhibitors.

** Conclusion
We have demonstrated that GPU-accelerated Parallel Genetic Algorithms can transform Subgroup Discovery from a theoretical exercise into a rigorous biological tool. By robustly identifying distinct cell states hidden within complex PD data, this framework provides a clear map of the heterogeneous landscape of neurodegeneration.
